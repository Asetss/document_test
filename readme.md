Все раскидал как нужно в рамках фреймворка.

* Разделил логику на контроллер 
* Запросы в репозитории.
* Раскидал логику в класс менеджер.


Код не проверял и не запускал, просто раскидал, как должно быть)